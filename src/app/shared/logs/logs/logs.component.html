<!-- logs.component.html -->
<div class="grid">
    <div class="col-12 md:col-10 lg:col-10 mx-auto">
        <div class="card logs-card p-3 md:p-4">
            <div class="flex align-items-center justify-content-center mb-3">
                <h1 class="m-0 text-center">Logs</h1>
            </div>

            <div class="flex justify-content-start gap-4 m-4">
                <span class="p-input-icon-left w-full md:w-20rem">
                    <i class="pi pi-search"></i>
                    <input pInputText class="w-full" type="text" placeholder="Buscar (usuario, acción, método, status)…"
                        (input)="onSearch($event)" />
                </span>
                <p-button label="Volver al catologo" icon="pi pi-replay" severity="secondary"
                    (click)="navigateCat()"></p-button>
            </div>

            <p-table [value]="(logs$ | async) ?? []" [loading]="(loading$ | async) ?? false" [rowTrackBy]="trackById"
                [tableStyle]="{ 'min-width': '40rem' }" class="logs-table">
                <ng-template pTemplate="header">
                    <tr>
                        <th style="width: 5rem">#</th>
                        <th style="width: 14rem">Fecha (AR)</th>
                        <th>Usuario</th>
                        <th>Acción</th>
                        <th style="width: 6rem">Método</th>
                        <th style="width: 6rem">Status</th>
                    </tr>
                </ng-template>

                <ng-template pTemplate="body" let-row>
                    <tr>
                        <td>{{ row.id }}</td>
                        <td>{{ row.timestamp | date:'dd/MM/yyyy HH:mm:ss' }}</td>
                        <td>{{ row.username || '(vacío)' }}</td>
                        <td class="truncate-2">{{ row.action }}</td>
                        <td>{{ row.method }}</td>
                        <td>
                            <p-tag [value]="row.status" [severity]="statusToSeverity(row.status)"></p-tag>
                        </td>
                    </tr>
                </ng-template>
            </p-table>

            <div class="flex justify-content-center mt-3">
                <p-paginator [rows]="(size$ | async) ?? 20" [totalRecords]="(total$ | async) ?? 0" [first]="first"
                    (onPageChange)="onPageChange($event)" [rowsPerPageOptions]="[20, 50, 100, 200, 300]">
                </p-paginator>

                <!-- ... -->
                <p-scrollTop target="window" [threshold]="200" styleClass="custom-scrolltop" icon="pi pi-arrow-up" />

            </div>
        </div>
    </div>
</div>